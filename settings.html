<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <link rel="stylesheet" href="hoved.css">
</head>
<style>
    #sidebar {
        justify-content: space-between;
        height: 95vh;
    }
</style>

<body>
    <!-- To do!
    Nettsiden skal ha konstant bredde hvis bredden på skjermen er større en 1200 px 
    .container gjør dette for oss
    vi skal dele opp .container i en venstre- og høyrekolonne der høyrekolonne tar størst plass
    venstrekolonne vil bli delt opp i 2 deler den ene er logo + meny. den andre delen er bruker sin profil
    Høyre kolonne vil bli delt opp i 2 deler den ene er størst og vil ligge mer mot midten av siden vi kaller denne Midtkolonne. den andre delen vil fungere som en sidebar hvor man kan søke etter bruker og kunen følge tilfeldige bruker som er valgt av programmet 
    Midtkolonnen vil bli delt opp i 2 deler overskift/tabs og den andre delen vil være en feed. -->



    <div class="container">
        <div class="hovedflex">
            <div id="venstrekolonne">
                <div id="meny">
                    <a href="home.html" id="logo" class="hiddenButton">
                        <img src="bilder/BARK.png" width="40" alt="BARK.png" class="logoIkon">
                    </a>
                    <div id="menyknapper">
                        <a href="home.html" class="hiddenButton genericButton" id="menyhjem">
                            <img src="bilder/home_hul.png" height="30" alt="">
                            <div class="buttonText">Hjem</div>
                        </a>


                        <a href="viewprofile.html?brukernavn=brukernavn" class="hiddenButton genericButton"
                            id="menyprofil">
                            <img src="bilder/profil_hul.png" height="30" alt="">
                            <div class="buttonText">Profil</div>
                        </a>
                        <a href="settings.html" class="boldText hiddenButton genericButton" id="menyinnstillinger">
                            <img src="bilder/settings.png" height="30" alt="">
                            <div class="buttonText">Innstillinger</div>
                        </a>

                    </div>

                </div>
                <div class="profil">
                    <button class="profilknapp genericButton hiddenButton">

                        <div>
                            <img class="profilbilde"
                                src="https://cdn.discordapp.com/attachments/1095708777027739668/1096797766228918313/IT_logo.png"
                                alt="pfp" height="50" width="50">
                            <div class="mediumWidth profilnavn">
                                <div class="mediumWidth profilNavnNavn">Navn</div>
                                <div class="mediumWidth profilNavnId">@Brukernavn</div>
                            </div>



                        </div>
                        <div id="mediumWidth menyindikator">
                            <img src="bilder/tredots.png" width="30" height="30" alt="" class="mediumWidth">
                        </div>
                    </button>
                </div>
                <div id="popupLogout" tabindex="0">
                    <a href="viewprofile.html?brukernavn=brukernavn" id="popupViewProfile" tabindex="0"
                        class="genericButton hiddenButton">Profil</a>
                    <a href="settings.html" id="popupSettings" class="genericButton hiddenButton"
                        tabindex="0">Innstillinger</a>
                    <button id="popupLogoutButton" class="genericButton hiddenButton" tabindex="0"> Logg ut</button>
                </div>

            </div>
            <div id="hoyrekolonne">
                <div id="midtkolonne">
                    <div id="overskrift">
                        <div id="viewprofileTopp">
                            <button class="backButton genericButton hiddenButton">
                                <img src="bilder/pil_svart.png" alt="arrow" width="30">
                            </button>
                            <h3>Settings</h3>
                        </div>
                        <div id="overskrifttabs">
                            <button id="settingsProfile" class="overskriftknapp hiddenButton">
                                <div>
                                    Profile
                                    <div class="line"></div>
                                </div>
                            </button>
                            <button id="settingsAppearance" class="overskriftknapp hiddenButton">
                                <div>
                                    Appearance
                                    <div class="line"></div>
                                </div>
                            </button>
                            <button id="settingsOther" class="overskriftknapp hiddenButton">
                                <div>
                                    Other
                                    <div class="line"></div>
                                </div>
                            </button>
                        </div>
                    </div>
                    <div id="feed">
                        <div id="settingsEditProfile" class="settingsTabKeys" style="display: block;">

                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditProfileDisplayName">Name</label>
                                <input type="text" id="settingsEditProfileDisplayName"
                                    name="settingsEditProfileDisplayName" class="inputText"
                                    placeholder="Micahale jacksonscript">
                            </div>
                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditProfileBanner">Profile banner</label>
                                <input type="file" id="settingsEditProfileBanner" name="settingsEditProfileBanner"
                                    class="inputFile" accept="image/*">
                            </div>
                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditProfilePicture">Profile picture</label>
                                <input type="file" id="settingsEditProfilePicture" name="settingsEditProfilePicture"
                                    class="inputFile" accept="image/*">
                            </div>

                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditBio">Bio</label>
                                <textarea id="settingsEditBio" name="settingsEditBio" class="inputTextarea"
                                    placeholder="Rewrite your bio..."></textarea>
                            </div>
                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditProfileLocation">Location</label>
                                <input type="text" id="settingsEditProfileLocation" name="settingsEditProfileLocation"
                                    class="inputText" placeholder="Your Current City">
                            </div>


                        </div>
                        <div id="settingsEditAppearance" class="settingsTabKeys" style="display: none;">
                            <div class="inputfield">
                                <div class="settingssTitles">Color theme</div>

                                <div class="horisontalFlex colorThemes">
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditAppearanceColorThemeLight">Light</label>
                                        <input type="radio" name="colorThemeType"
                                            id="settingsEditAppearanceColorThemeLight"
                                            class="settingsEditAppearanceColorThemeType" value="light">
                                    </div>
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditAppearanceColorThemeDark">Dark</label>
                                        <input type="radio" name="colorThemeType"
                                            id="settingsEditAppearanceColorThemeDark"
                                            class="settingsEditAppearanceColorThemeType" value="dark">
                                    </div>
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditAppearanceColorThemeCustom">Custom</label>
                                        <input type="radio" name="colorThemeType"
                                            id="settingsEditAppearanceColorThemeCustom"
                                            class="settingsEditAppearanceColorThemeType" value="custom">
                                    </div>
                                </div>

                                <div class="customColors grayBorder">
                                    <div class="horisontalFlex">
                                        <label for="customColorBackground">Background Color:</label>
                                        <input type="color" name="" id="customColorBackground" value="#ffffff">

                                    </div>
                                    <div class="horistontalFlex">
                                        <label for="customColorText">Text Color:</label>
                                        <input type="color" name="" id="customColorText">
                                    </div>
                                </div>

                            </div>
                            <div class="inputfield">
                                <div class="settingssTitles">Font Size</div>
                                <div id="fontsizepreview">
                                    Current Fontsize is 16px
                                </div>
                                <div class="fontsizeflex">

                                    <div class="litenfontsizetext"> aA </div>
                                    <input type="range" step="4" min="8" max="24">
                                    <div class="storfontsizetext"> aA </div>
                                </div>
                            </div>


                        </div>
                        <div id="settingsEditOther" class="settingsTabKeys" style="display: none;">

                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditOtherSound">Bark sounds</label>
                                <div class="horisontalFlex ">
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditOtherSoundOn">On</label>
                                        <input type="radio" name="barkSound" id="settingsEditOtherSoundOn"
                                            class="settingsEditOtherSoundType" value="true">
                                    </div>
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditOtherSoundOff">Off</label>
                                        <input type="radio" name="barkSound" id="settingsEditOtherSoundOff"
                                            class="settingsEditOtherSoundType" value="false">
                                    </div>

                                </div>
                            </div>
                            <div class="inputfield">
                                <label class="settingssTitles" for="settingsEditOtherText">Bark text</label>
                                <div class="horisontalFlex">
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditOtherTextOn">On</label>
                                        <input type="radio" name="barkText" id="settingsEditOtherTextOn"
                                            class="settingsEditOtherTextType" value="true">
                                    </div>
                                    <div class="radioElement grayBorder">
                                        <label for="settingsEditOtherTextOff">Off</label>
                                        <input type="radio" name="barkText" id="settingsEditOtherTextOff"
                                            class="settingsEditOtherTextType" value="false">
                                    </div>

                                </div>
                            </div>



                        </div>
                    </div>
                    <div class="settingsSidebarButtonFlex telefontweeting horisontalFlex">
                        <button class="settingsButtonDiscard settingsSidebarButton genericButton">Discard</button>
                        <button class="settingsButtonSave settingsSidebarButton vanligKnapp genericButton">Save</button>
                    </div>
                    <div class="settingsSidebarButtonFlex smallWidth fixedbunnhoyre horisontalFlex">
                        <button class="settingsButtonDiscard settingsSidebarButton genericButton">Discard</button>
                        <button class="settingsButtonSave settingsSidebarButton vanligKnapp genericButton">Save</button>
                    </div>

                </div>
                <div id="sidebar">

                    <div class="whotofollow">
                        <div class="whotofollowheader">Preview</div>
                        <div class="whotofollowbody">
                            <div class="profileDisplay">
                                <div id="profilebanner">
                                    <img src="https://cdn.discordapp.com/attachments/1095708777027739668/1096797766228918313/IT_logo.png"
                                        alt="profilebanner" id="profilebannerimg">

                                </div>

                                <div id="profilePfpShare">
                                    <div>
                                        <img src="https://cdn.discordapp.com/attachments/1095708777027739668/1096797766228918313/IT_logo.png"
                                            alt="pfp" id="overskriftPfp" width="150" height="150">
                                    </div>
                                    <button class="genericButton vanligKnapp">Follow</button>
                                </div>
                                <div id="profileTextBody">

                                    <h3 id="profileDisplayName">Elon Musk</h3>
                                    <div id="profileBrukernavn">@elonmusk</div>
                                    <div id="profileBio">i am a spaceX engineer bla bla bal...</div>

                                    <div id="profileLocation">
                                        <img id="profileLocationIcon" src="bilder/geotag_hul.png" width="20" height="20"
                                            alt="map marker icon">
                                        <div id="profileLocationName">MArs</div>
                                    </div>

                                    <div id="profileFollowingFollowers">
                                        <div id="profileFollowing">
                                            <div>300</div>
                                            <div>Following</div>
                                        </div>
                                        <div id="profileFollowers">
                                            <div>300</div>
                                            <div>Followers</div>
                                        </div>
                                    </div>
                                </div>


                            </div>


                        </div>
                    </div>


                    <div class="settingsSidebarButtonFlex fixedbunnhoyre horisontalFlex">
                        <button class="settingsButtonDiscard settingsSidebarButton genericButton">Discard</button>
                        <button class="settingsButtonSave settingsSidebarButton vanligKnapp genericButton">Save</button>
                    </div>

                </div>

            </div>

        </div>

    </div>




</body>

<script src="javascript/lib.js"></script>
<script src="javascript/redirectHvisLoggetUt.js"></script>
<script src="javascript/profilemenu.js"></script>
<script src="javascript/visprofil.js"></script>
<script src="javascript/urlbarHistory.js"></script>
<script>
    leggTilHistory();
    oppdaterProfil(hentInnloggetBrukerId());
    setPageState();

    let editedParams = {
        "displayName": false,
        "bio": false,
        "location": false,
        "theme": false,
        "barkSound": false,
        "barkText": false,
        "pfp": false,
        "banner": false
    }
    function setPageState() {
        let brukerId = hentInnloggetBrukerId();
        oppdaterProfil(brukerId);
        let bruker = hentBruker(brukerId);

        let inputs = document.querySelectorAll("input[type=file]");
        for (let i = 0; i < inputs.length; i++) {
            inputs[i].value = "";
        }

        // profile
        let settingsEditProfileDisplayName = document.querySelector("#settingsEditProfileDisplayName");
        settingsEditProfileDisplayName.value = bruker["displayName"];
        settingsEditProfileDisplayName.placeholder = bruker["displayName"];

        let settingsEditBio = document.querySelector("#settingsEditBio");
        settingsEditBio.value = bruker["bio"];

        let settingsEditProfileLocation = document.querySelector("#settingsEditProfileLocation");
        settingsEditProfileLocation.value = bruker["location"];


        // appearance
        let themeRadios = document.querySelectorAll(".settingsEditAppearanceColorThemeType");
        for (let i = 0; i < themeRadios.length; i++) {
            if (themeRadios[i].value == bruker["settings"]["theme"]) {
                themeRadios[i].checked = true;
            } else {
                themeRadios[i].checked = false;

            }
            if (bruker["settings"]["theme"] == "custom") {
                document.querySelector(".customColors").style.display = "flex";

            } else {
                document.querySelector(".customColors").style.display = "none";
            }
        }
        document.querySelector("#customColorText").value = bruker["settings"]["text-color"];
        document.querySelector("#customColorBackground").value = bruker["settings"]["background-color"];

        console.log(bruker["settings"]["theme"])
        let body = document.querySelector("body");
        if (bruker["settings"]["theme"] == "light") {
            console.log("light")
            body.style.setProperty("--globalfg", "#404040")
            body.style.setProperty("--globalbg", "#ffffff")
            body.style.setProperty("--globalbg2", "#ffffffcd")
        }
        if (bruker["settings"]["theme"] == "dark") {
            console.log("dark")
            body.style.setProperty("--globalfg", "#ffffff")
            body.style.setProperty("--globalbg", "#282c34")
            body.style.setProperty("--globalbg2", "#282c34cd")
        }
        if (bruker["settings"]["theme"] == "custom") {
            console.log("custom")
            body.style.setProperty("--globalfg", bruker["settings"]["text-color"].value)
            body.style.setProperty("--globalbg", bruker["settings"]["background-color"].value)
            body.style.setProperty("--globalbg2", bruker["settings"]["background-color"].value + "cd")
        }

        let fontsizeflexInput = document.querySelector(".fontsizeflex>input");
        fontsizeflexInput.value = bruker["settings"]["font-size"]
        changefontsizepreview()

        body.style.fontSize = fontsizeflexInput.value + "px"

        let barkSoundRadio = document.querySelectorAll(".settingsEditOtherSoundType");
        for (let i = 0; i < barkSoundRadio.length; i++) {
            if (barkSoundRadio[i].value == bruker["settings"]["barkSound"]) {
                barkSoundRadio[i].checked = true;
            } else {
                barkSoundRadio[i].checked = false;

            }

        }

        let barkTextRadio = document.querySelectorAll(".settingsEditOtherTextType");
        for (let i = 0; i < barkTextRadio.length; i++) {
            if (barkTextRadio[i].value == bruker["settings"]["barkText"]) {
                barkTextRadio[i].checked = true;
            } else {
                barkTextRadio[i].checked = false;

            }

        }





    }


    let discardKnapper = document.querySelectorAll(".settingsButtonDiscard");

    for (let i = 0; i < discardKnapper.length; i++) {
        discardKnapper[i].addEventListener("click", setPageState);
    }

    let saveKnapper = document.querySelectorAll(".settingsButtonSave");
    for (let i = 0; i < saveKnapper.length; i++) {
        saveKnapper[i].addEventListener("click", saveSettings);
    }


    async function saveSettings() {
        let brukerId = hentInnloggetBrukerId();
        let bruker = hentBruker(brukerId);

        let inputs = document.querySelectorAll("input[type=file]");
        if (inputs[0].files.length > 0) {
            let bannerFile = inputs[0].files[0];
            let bannerURL = await readfile(bannerFile);
            bruker["bannerImage"] = bannerURL;
        }
        if (inputs[1].files.length > 0) {
            let pfpFile = inputs[1].files[0];
            let pfpURL = await readfile(pfpFile);
            bruker["pfpImage"] = pfpURL;
        }

        // profile
        let settingsEditProfileDisplayName = document.querySelector("#settingsEditProfileDisplayName");
        bruker["displayName"] = settingsEditProfileDisplayName.value.length > 0 ? settingsEditProfileDisplayName.value : settingsEditProfileDisplayName.placeholder;

        let settingsEditBio = document.querySelector("#settingsEditBio");
        bruker["bio"] = settingsEditBio.value;

        let settingsEditProfileLocation = document.querySelector("#settingsEditProfileLocation");
        bruker["location"] = settingsEditProfileLocation.value;


        // appearance
        let themeRadios = document.querySelectorAll(".settingsEditAppearanceColorThemeType");
        for (let i = 0; i < themeRadios.length; i++) {
            if (themeRadios[i].checked == true) {
                bruker["settings"]["theme"] = themeRadios[i].value;
            }
        }
        bruker["settings"]["text-color"] = document.querySelector("#customColorText").value;
        bruker["settings"]["background-color"] = document.querySelector("#customColorBackground").value;


        let fontsizeflexInput = document.querySelector(".fontsizeflex>input");
        bruker["settings"]["font-size"] = fontsizeflexInput.value

        let barkSoundRadio = document.querySelectorAll(".settingsEditOtherSoundType");
        for (let i = 0; i < barkSoundRadio.length; i++) {
            if (barkSoundRadio[i].checked == true) {
                bruker["settings"]["barkSound"] = barkSoundRadio[i].value;
            }

        }

        let barkTextRadio = document.querySelectorAll(".settingsEditOtherTextType");
        for (let i = 0; i < barkTextRadio.length; i++) {
            if (barkTextRadio[i].checked == true) {
                bruker["settings"]["barkText"] = barkTextRadio[i].value;
            }
        }

        lagreData(["users", brukerId], bruker);
    }

    makeEventListenersForLiveUpdating();
    function makeEventListenersForLiveUpdating() {
        let profilebannerimg = document.querySelector("#profilebannerimg"); // img
        let profilebanner = document.querySelector("#profilebanner"); // brukes for solid farge
        let profilePfp = document.querySelector("#overskriftPfp"); //img
        let profileDisplayName = document.querySelector("#profileDisplayName");
        let profileBrukernavn = document.querySelector("#profileBrukernavn");
        let profileBio = document.querySelector("#profileBio");
        let profileLocationName = document.querySelector("#profileLocationName");


        let settingsEditProfileDisplayName = document.querySelector("#settingsEditProfileDisplayName");

        let settingsEditProfileBanner = document.querySelector("#settingsEditProfileBanner");
        let settingsEditProfilePicture = document.querySelector("#settingsEditProfilePicture");

        let settingsEditBio = document.querySelector("#settingsEditBio");
        let settingsEditProfileLocation = document.querySelector("#settingsEditProfileLocation");

        let themeRadios = document.querySelectorAll(".settingsEditAppearanceColorThemeType");
        let customColorText = document.querySelector("#customColorText");
        let customColorBackground = document.querySelector("#customColorBackground");

        let fontsizeflexInput = document.querySelector(".fontsizeflex>input");

        let barkSoundRadio = document.querySelectorAll(".settingsEditOtherSoundType");
        let barkTextRadio = document.querySelectorAll(".settingsEditOtherTextType");

        settingsEditProfileDisplayName.addEventListener("input", function () {
            profileDisplayName.innerHTML = settingsEditProfileDisplayName.value.length > 0 ? settingsEditProfileDisplayName.value : settingsEditProfileDisplayName.placeholder;
        });

        settingsEditProfileBanner.addEventListener("change", async function () {
            let inputs = document.querySelectorAll("input[type=file]");
            let bannerFile = inputs[0].files[0];
            let bannerURL = await readfile(bannerFile);
            profilebannerimg.src = bannerURL;
        });

        settingsEditProfilePicture.addEventListener("change", async function () {
            let inputs = document.querySelectorAll("input[type=file]");
            let pfpFile = inputs[1].files[0];
            let pfpURL = await readfile(pfpFile);
            profilePfp.src = pfpURL;
        });

        settingsEditBio.addEventListener("input", function () {
            profileBio.innerHTML = settingsEditBio.value;
        });

        settingsEditProfileLocation.addEventListener("input", function () {
            if (settingsEditProfileLocation.value == "") {
                document.querySelector("#profileLocation").style.display = "none";
            } else {
                document.querySelector("#profileLocation").style.display = "flex";
            }
            profileLocationName.innerHTML = settingsEditProfileLocation.value;
        });
        let colorthemeRadioButtons = document.querySelectorAll(".colorThemes .radioElement")
        for (let i = 0; i < colorthemeRadioButtons.length; i++) {
            colorthemeRadioButtons[i].addEventListener("click", function (e) {
                let parent = e.target;
                while (!parent.classList.contains("radioElement")) { // loop til den finner radioElement i classList
                    parent = parent.parentElement;
                }
                let radioEl = parent.querySelector("input");
                let body = document.querySelector("body");
                if (radioEl.value == "light") {
                    console.log("light")
                    body.style.setProperty("--globalfg", "#404040")
                    body.style.setProperty("--globalbg", "#ffffff")
                    body.style.setProperty("--globalbg2", "#ffffffcd")
                }
                if (radioEl.value == "dark") {
                    console.log("dark")
                    body.style.setProperty("--globalfg", "#ffffff")
                    body.style.setProperty("--globalbg", "#282c34")
                    body.style.setProperty("--globalbg2", "#282c34cd")
                }
                if (radioEl.value == "custom") {
                    console.log("custom")
                    let customColorText = document.querySelector("#customColorText");
                    let customColorBackground = document.querySelector("#customColorBackground");
                    body.style.setProperty("--globalfg", customColorText.value)
                    body.style.setProperty("--globalbg", customColorBackground.value)
                    body.style.setProperty("--globalbg2", customColorBackground.value + "cd")
                }
            });
        }

        customColorText.addEventListener("input", function () {
            let body = document.querySelector("body");
            body.style.setProperty("--globalfg", customColorText.value)
        });

        customColorBackground.addEventListener("input", function () {
            let body = document.querySelector("body");
            body.style.setProperty("--globalbg", customColorBackground.value)
            body.style.setProperty("--globalbg2", customColorBackground.value + "cd")
        });

        fontsizeflexInput.addEventListener("change", function () {
            let body = document.querySelector("body");
            body.style.fontSize = fontsizeflexInput.value + "px"
        });

        for (let i = 0; i < barkSoundRadio.length; i++) {
            barkSoundRadio[i].addEventListener("change", function () {
                if (barkSoundRadio[i].checked == true) {
                    if (barkSoundRadio[i].value == "true") {
                    }
                    if (barkSoundRadio[i].value == "false") {
                    }
                }
            });
        }






        // let inputs = document.querySelectorAll("input[type=file]");
        // if (inputs[0].files.length == 0) {

        // }
        // profilebannerimg.src = bruker["bannerImage"];
        // profilebanner.style.backgroundColor = bruker.bannerColor;

        // profilePfp.src = bruker["profileImage"];
        // profileDisplayName.innerHTML = bruker["displayName"];
        // profileBrukernavn.innerHTML = "@" + brukernavn;
        // profileBio.innerHTML = bruker["bio"];
        // profileLocationName.innerHTML = bruker["location"];

        // if (bruker["location"] == "") {
        //     document.querySelector("#profileLocation").style.display = "none";
        // } else {
        //     document.querySelector("#profileLocation").style.display = "flex";
        // }


    }



    velgeoverskrifttabknapp({ target: { parentElement: { id: "settingsProfile" } } });

    function velgeoverskrifttabknapp(e) {
        console.log("hi")
        let overskriftprofilknapp = document.querySelector("#settingsProfile");
        let overskriftappearanceknapp = document.querySelector("#settingsAppearance");
        let overskriftotherknapp = document.querySelector("#settingsOther");
        let underline = document.querySelectorAll(".line");
        let settingsProfile = document.querySelector("#settingsEditProfile");
        let settingsAppearance = document.querySelector("#settingsEditAppearance");
        let settingsOther = document.querySelector("#settingsEditOther");

        if (e.target.id == "settingsProfile" || e.target.parentElement.id == "settingsProfile") {
            overskriftprofilknapp.children[0].children[0].style.display = "block"
            overskriftappearanceknapp.children[0].children[0].style.display = "none"
            overskriftotherknapp.children[0].children[0].style.display = "none"

            settingsProfile.style.display = "block";
            settingsAppearance.style.display = "none";
            settingsOther.style.display = "none";


        }
        if (e.target.id == "settingsAppearance" || e.target.parentElement.id == "settingsAppearance") {
            overskriftprofilknapp.children[0].children[0].style.display = "none"
            overskriftappearanceknapp.children[0].children[0].style.display = "block"
            overskriftotherknapp.children[0].children[0].style.display = "none"

            settingsProfile.style.display = "none";
            settingsAppearance.style.display = "block";
            settingsOther.style.display = "none";

        }
        if (e.target.id == "settingsOther" || e.target.parentElement.id == "settingsOther") {
            overskriftprofilknapp.children[0].children[0].style.display = "none"
            overskriftappearanceknapp.children[0].children[0].style.display = "none"
            overskriftotherknapp.children[0].children[0].style.display = "block"

            settingsProfile.style.display = "none";
            settingsAppearance.style.display = "none";
            settingsOther.style.display = "block";



        }
    }
    let overskriftKnapper = document.querySelectorAll(".overskriftknapp");
    for (let i = 0; i < overskriftKnapper.length; i++) {
        overskriftKnapper[i].addEventListener("click", velgeoverskrifttabknapp);
    }


    let range = document.querySelector(".fontsizeflex input");
    range.addEventListener("input", changefontsizepreview);

    function changefontsizepreview() {
        let fontsize = document.querySelector("#fontsizepreview");
        let fontsizeinput = document.querySelector(".fontsizeflex input");
        fontsize.innerHTML = "Current Fontsize is " + fontsizeinput.value + "px";

    }


    function selectRadioIfClicked(e) {
        let id = ""
        if (e.target.tagName != "DIV") {
            e.target.parentElement.children[1].checked = true;
            id = e.target.parentElement.children[1].id;
        } else {
            id = e.target.children[1].id;
            e.target.children[1].checked = true;
        }

        if (id == "settingsEditAppearanceColorThemeCustom") {
            document.querySelector(".customColors").style.display = "flex";
        } else {
            document.querySelector(".customColors").style.display = "none";
        }

    }
    let colorThemeButtons = document.querySelectorAll(".colorThemes .radioElement");
    for (let i = 0; i < colorThemeButtons.length; i++) {
        colorThemeButtons[i].addEventListener("click", selectRadioIfClicked);
    }











    let buttonLogout = document.querySelector("#popupLogoutButton");
    buttonLogout.addEventListener("click", loggUtBruker);



    let profil = document.querySelector(".profil > button");
    let popupElement = document.querySelector("#popupLogout");

    document.querySelector("#settingsProfile").addEventListener("focus", gjemPopup)
    popupElement.addEventListener("blur", gjemPopup);

    profil.addEventListener("focus", visPopup);

    profil.addEventListener("blur", gjemPopup);
    gjemPopup();
    async function gjemPopup() {
        await sleep(10);

        let elementer = document.querySelectorAll("#popupLogout > *, #popupLogout");
        let harFokus = false;
        for (let i = 0; i < elementer.length; i++) {
            if (elementer[i] == document.activeElement) {
                harFokus = true;
            }
        }
        if (harFokus) {
            return
        }

        console.log("gjemPopup");
        let popupLogout = document.querySelector("#popupLogout");
        popupLogout.style.display = "none";

    }
    function visPopup() {
        console.log("visPopup");
        let popupLogout = document.querySelector("#popupLogout");
        popupLogout.style.display = "block";
    }


    let menyprofil = document.querySelector("#menyprofil");
    menyprofil.href = "viewprofile.html?brukernavn=" + hentInnloggetBrukerId();
    menyprofil.addEventListener("click", function (event) {
        event.preventDefault();
        clearHistory();
        window.location.href = "viewprofile.html?brukernavn=" + hentInnloggetBrukerId();
    });

    


</script>

</html>